/* eslint-disable sonarjs/no-duplicate-string */
import { expectChildToMatch, spawnTestChild } from '../../helpers/index.js';
import { composeWalletCommand } from './helpers/index.js';

test('SUCCEEDS: Valid subaccount', async () => {
  const options =
    '--key valid-key --secret valid-secret --subaccount valid-subaccount';

  const command = composeWalletCommand(options);

  const expectedChild = {
    stdoutArray: [
      '┌──────────┬──────────────────────────┬─────────────────────────────┬─────────────────┬────────────────────┬─────────────────┬────────────┐',
      '│ Currency │ Available with borrowing │ Available without borrowing │ Borrowed        │ Total              │ Total (USD)     │ Allocation │',
      '├──────────┴──────────────────────────┴─────────────────────────────┴─────────────────┴────────────────────┴─────────────────┴────────────┤',
      '│                                                      Subaccount: valid-subaccount                                                       │',
      '├──────────┬──────────────────────────┬─────────────────────────────┬─────────────────┬────────────────────┬─────────────────┬────────────┤',
      '│ BTC      │ 123.45678912 BTC         │ 12.34567891 BTC             │ 1.23456789 BTC  │ 1234.56789123 BTC  │ $123,456,789.12 │     20.00% │',
      '├──────────┼──────────────────────────┼─────────────────────────────┼─────────────────┼────────────────────┼─────────────────┼────────────┤',
      '│ ETH      │ 123.45678912 ETH         │ 12.34567891 ETH             │ 1.23456789 ETH  │ 1234.56789123 ETH  │ $123,456,789.12 │     20.00% │',
      '├──────────┼──────────────────────────┼─────────────────────────────┼─────────────────┼────────────────────┼─────────────────┼────────────┤',
      '│ FTT      │ 123.45678912 FTT         │ 12.34567891 FTT             │ 1.23456789 FTT  │ 1234.56789123 FTT  │ $123,456,789.12 │     20.00% │',
      '├──────────┼──────────────────────────┼─────────────────────────────┼─────────────────┼────────────────────┼─────────────────┼────────────┤',
      '│ USD      │ 123.45678912 USD         │ 12.34567891 USD             │ 1.23456789 USD  │ 1234.56789123 USD  │ $123,456,789.12 │     20.00% │',
      '├──────────┼──────────────────────────┼─────────────────────────────┼─────────────────┼────────────────────┼─────────────────┼────────────┤',
      '│ USDT     │ 123.45678912 USDT        │ 12.34567891 USDT            │ 1.23456789 USDT │ 1234.56789123 USDT │ $123,456,789.12 │     20.00% │',
      '├──────────┼──────────────────────────┴─────────────────────────────┴─────────────────┴────────────────────┼─────────────────┼────────────┤',
      '│ Total    │                                                                                               │ $617,283,945.62 │            │',
      '└──────────┴───────────────────────────────────────────────────────────────────────────────────────────────┴─────────────────┴────────────┘',
    ],
    stderrArray: [],
    exitCode: 0,
  };

  const child = spawnTestChild(command);

  await expectChildToMatch(child, expectedChild);
});
